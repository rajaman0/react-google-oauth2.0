module.exports=function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t){e.exports=require("react")},function(e,t,n){"use strict";n.r(t),n.d(t,"GoogleButton",(function(){return _})),n.d(t,"isLoggedIn",(function(){return s})),n.d(t,"logOutOAuthUser",(function(){return u})),n.d(t,"createOAuthHeaders",(function(){return p})),n.d(t,"GoogleAuth",(function(){return T})),n.d(t,"GoogleAuthConsumer",(function(){return k})),n.d(t,"getAccessToken",(function(){return l})),n.d(t,"setPrompt",(function(){return x})),n.d(t,"exchangeToken",(function(){return d})),n.d(t,"removeOAuthQueryParams",(function(){return f})),n.d(t,"serverResponse",(function(){return i})),n.d(t,"storeAccessToken",(function(){return a}));var o=function(){return(o=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},r=function(e,t,n,o){return new(n||(n=Promise))((function(r,c){function i(e){try{s(o.next(e))}catch(e){c(e)}}function a(e){try{s(o.throw(e))}catch(e){c(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}s((o=o.apply(e,t||[])).next())}))},c=function(e,t){var n,o,r,c,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return c={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function a(c){return function(a){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,o&&(r=2&c[0]?o.return:c[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,c[1])).done)return r;switch(o=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,o=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(r=i.trys,(r=r.length>0&&r[r.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){i.label=c[1];break}if(6===c[0]&&i.label<r[1]){i.label=r[1],r=c;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(c);break}r[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],o=0}finally{n=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,a])}}};function i(e){var t=e.code;(function(e,t){return r(this,void 0,void 0,(function(){return c(this,(function(n){switch(n.label){case 0:return[4,fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})];case 1:return[2,n.sent().json()]}}))}))})(e.apiUrl,{code:t,scope:e.scope}).then((function(t){"access_token"in t?e.setResponseState({accessToken:t.access_token}):e.setResponseState({error:"so access_token in response data!"})})).catch((function(t){e.setResponseState({error:t.message})}))}function a(e){window.localStorage.setItem("accessToken",e)}function s(){return!!window.localStorage.getItem("accessToken")}function u(){window.localStorage.removeItem("accessToken")}function l(){return window.localStorage.getItem("accessToken")}function p(e){var t={};return e&&(t={"X-Auth-Resource":e}),o(o({},t),{"X-Auth-Token":"Bearer "+l()})}function f(){var e=document.location.href;if(document.location.search){var t=e.substring(0,e.indexOf("?"));window.history.replaceState({},document.title,t)}}function d(e,t,n){var o="https://oauth2.googleapis.com/token?";return o+="client_id="+e,o+="&grant_type=refresh_token",o+="&refresh_token="+t,o+="&client_secret="+n,fetch(o,{method:"POST"}).then((function(e){return e.json().then((function(e){if(e.error)throw new Error(e.error);return window.localStorage.setItem("accessToken",e.access_token),e.access_token}))})).catch((function(e){throw console.debug(e),new Error("Failed to refresh access token")}))}var h,g=n(0),b=n.n(g);!function(e){e.GOOGLE_OAUTH_ENDPOINT="https://accounts.google.com/o/oauth2/v2/auth"}(h||(h={}));var v=function(){function e(e,t){var n=this;this.redirect=function(e){if(!n.googleRedirectURL)throw new ReferenceError("Error creating redirect url to Google's authorization server");window.location.replace(n.googleRedirectURL)},this.params=e,this.scopesStr=t}return Object.defineProperty(e.prototype,"googleRedirectURL",{get:function(){return this._googleRedirectURL},set:function(e){this._googleRedirectURL=e},enumerable:!1,configurable:!0}),e.prototype.createAuthorizationRequestURL=function(){var e,t=this.params,n=t.accessType,o=void 0===n?"offline":n,r=t.includeGrantedScopes,c=void 0===r||r,i=t.responseType,a=void 0===i?"code":i,s=t.state,u=void 0===s?null:s,l=t.redirectUri,p=t.clientId,f=t.loginHint,d=t.prompt;e=h.GOOGLE_OAUTH_ENDPOINT+"?scope="+this.scopesStr+"&",e=(e=(e=o?e+"access_type="+o+"&":e)+"include_granted_scopes="+c+"&")+"response_type="+a+"&",e=u?e+"state="+u+"&":e,e=f?e+"login_hint="+f+"&":e,e=(e=(e=d?e+"prompt="+d+"&":e)+"redirect_uri="+l+"&")+"client_id="+p,this.googleRedirectURL=e},e.createScopes=function(e){var t="";return e.map((function(n,o){e.length-1===o?t+=""+n:t+=n+"%20"})),t},e}(),m=function(){return(m=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},y={},O={backgroundSize:"20px 20px",backgroundRepeat:"no-repeat",backgroundPosition:"12px 10px",textIndent:"19px",border:"1px solid #bdc3c7",padding:"9px 23px",borderRadius:"9px",backgroundColor:"#bdc3c7",fontSize:"18px"},S=b.a.createContext({setOAuthState:function(){},setOptions:function(){},setPrompt:function(){},setResponseState:function(){}}),w=S.Provider,k=S.Consumer,R=function(e){var t=e.placeholder,n=void 0===t?"":t,o=e.defaultStyle,r=void 0===o||o,c=e.options,i=e.displayErrors,a=void 0!==i&&i,s=v.createScopes(c.scopes),u=new v(c,s);u.createAuthorizationRequestURL();var l=r?function(e,t){return e?m(m({},t),{backgroundImage:"url("+e+")"}):t}(n,O):void 0;return e.error&&console.error("[React-Google-OAuth2] Error: "+e.error+"\n         - To display the error to the user, set IGoogleProps displayErrors to true.\n         See https://joegasewicz.github.io/react-google-oauth2.0/"),f(),b.a.createElement(b.a.Fragment,null,b.a.createElement("button",{style:l,onClick:u.redirect,className:e.className+" google-oauth-btn"},e.children),a&&e.error&&b.a.createElement("div",null,e.error))};function _(e){var t=e.callback,n=Object(g.useContext)(S),o=n.options,r=n.setOptions,c=n.responseState,u=n.setOAuthState,l=n.setResponseState,p=n.isAuthenticated,d=Object(g.useState)(),h=d[0],v=d[1],y=new URLSearchParams(window.location.search),O=y.get("code"),w=y.get("error");Object(g.useEffect)((function(){!o&&r&&r(e.options)}),[e.options]),Object(g.useEffect)((function(){c&&!Object.keys(c).length&&h&&i(h)}),[h,c]),Object(g.useEffect)((function(){(null==c?void 0:c.accessToken)&&!s()&&(a(c.accessToken),console.debug("`accessToken` set in local storage."),"function"!=typeof u||p||u(!0))}),[null==c?void 0:c.accessToken]);var k=m(m({},e.options),o),_=b.a.createElement(R,m({},e,{placeholder:e.placeholder,error:null==c?void 0:c.error,options:k}));if(null==c?void 0:c.error)return console.error("[React-Google-OAuth2] Error: Api call failed with "+(null==c?void 0:c.error)+" error."),_;if(O&&!s()){var x={email:y.get("email")||"",scope:y.get("scope")||"",code:O,client_id:e.options.clientId,apiUrl:e.apiUrl,responseState:c,setResponseState:l};return f(),c&&!Object.keys(c).length&&v(x),console.debug("Waiting for remote api response"),t?t():b.a.createElement(b.a.Fragment,null,"Loading...")}return w?(console.error("Error: Google login attempt failed with "+w+" error."),_):_}function x(e,t){return function(n){t&&!t.prompt&&e(m(m({},t),{prompt:n}))}}var T=function(e){var t=Object(g.useState)(y),n=t[0],o=t[1],r=Object(g.useState)(s()),c=r[0],i=r[1],a=Object(g.useState)(),u=a[0],l=a[1],p={isAuthenticated:c,setOAuthState:i,responseState:n,setResponseState:o,options:u,setOptions:l,setPrompt:x(l,u)};return b.a.createElement(w,{value:p},e.children)}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9yZWFjdC1nb29nbGUtb2F1dGgvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vcmVhY3QtZ29vZ2xlLW9hdXRoL2V4dGVybmFsIFwicmVhY3RcIiIsIndlYnBhY2s6Ly9yZWFjdC1nb29nbGUtb2F1dGgvLi9zcmMvYXBpVXRpbHMudHMiLCJ3ZWJwYWNrOi8vcmVhY3QtZ29vZ2xlLW9hdXRoLy4vc3JjL2F1dGhvcml6YXRpb24udHMiLCJ3ZWJwYWNrOi8vcmVhY3QtZ29vZ2xlLW9hdXRoLy4vc3JjL2NvbXBvbmVudHMudHN4Il0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwicmVxdWlyZSIsInNlcnZlclJlc3BvbnNlIiwicHJvcHMiLCJjb2RlIiwiYXBpVXJsIiwicGF5bG9hZCIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwianNvbiIsInBvc3RUb0V4Y2hhbmdlQXBpVXJsIiwic2NvcGUiLCJ0aGVuIiwiZGF0YSIsInNldFJlc3BvbnNlU3RhdGUiLCJhY2Nlc3NUb2tlbiIsImFjY2Vzc190b2tlbiIsImVycm9yIiwiY2F0Y2giLCJlcnIiLCJtZXNzYWdlIiwic3RvcmVBY2Nlc3NUb2tlbiIsInRva2VuIiwid2luZG93IiwibG9jYWxTdG9yYWdlIiwic2V0SXRlbSIsImlzTG9nZ2VkSW4iLCJnZXRJdGVtIiwibG9nT3V0T0F1dGhVc2VyIiwicmVtb3ZlSXRlbSIsImdldEFjY2Vzc1Rva2VuIiwiY3JlYXRlT0F1dGhIZWFkZXJzIiwicmVzb3VyY2UiLCJyZXNvdXJjZUhlYWRlcnMiLCJyZW1vdmVPQXV0aFF1ZXJ5UGFyYW1zIiwiY3VycmVudExvY2F0aW9uIiwiZG9jdW1lbnQiLCJsb2NhdGlvbiIsImhyZWYiLCJzZWFyY2giLCJjbGVhbl91cmkiLCJzdWJzdHJpbmciLCJpbmRleE9mIiwiaGlzdG9yeSIsInJlcGxhY2VTdGF0ZSIsInRpdGxlIiwiZXhjaGFuZ2VUb2tlbiIsImNsaWVudElkIiwicmVmcmVzaFRva2VuIiwiY2xpZW50U2VjcmV0IiwidXJsIiwiR09PR0xFX09BVVRIMl9FWENIQU5HRV9UT0tFTl9VUkwiLCJFcnJvciIsImNvbnNvbGUiLCJkZWJ1ZyIsIkdvb2dsZUFQSUNvbm5lY3Rpb25TdHJpbmdzIiwicGFyYW1zIiwic2NvcGVzU3RyIiwicmVkaXJlY3QiLCJlIiwiZ29vZ2xlUmVkaXJlY3RVUkwiLCJSZWZlcmVuY2VFcnJvciIsInJlcGxhY2UiLCJ0aGlzIiwiX2dvb2dsZVJlZGlyZWN0VVJMIiwiY3JlYXRlQXV0aG9yaXphdGlvblJlcXVlc3RVUkwiLCJhY2Nlc3NUeXBlIiwiaW5jbHVkZUdyYW50ZWRTY29wZXMiLCJyZXNwb25zZVR5cGUiLCJzdGF0ZSIsInJlZGlyZWN0VXJpIiwibG9naW5IaW50IiwicHJvbXB0IiwiR09PR0xFX09BVVRIX0VORFBPSU5UIiwiY3JlYXRlU2NvcGVzIiwic2NvcGVzIiwic3RyIiwibWFwIiwibGVuZ3RoIiwiU0VSVkVSX1JFU1BPTlNFX1NUQVRFIiwiYnV0dG9uU3R5bGluZyIsImJhY2tncm91bmRTaXplIiwiYmFja2dyb3VuZFJlcGVhdCIsImJhY2tncm91bmRQb3NpdGlvbiIsInRleHRJbmRlbnQiLCJib3JkZXIiLCJwYWRkaW5nIiwiYm9yZGVyUmFkaXVzIiwiYmFja2dyb3VuZENvbG9yIiwiZm9udFNpemUiLCJHb29nbGVBdXRoQ29udGV4dCIsImNyZWF0ZUNvbnRleHQiLCJzZXRPQXV0aFN0YXRlIiwic2V0T3B0aW9ucyIsInNldFByb21wdCIsIkdvb2dsZUF1dGhQcm92aWRlciIsIlByb3ZpZGVyIiwiR29vZ2xlQXV0aENvbnN1bWVyIiwiQ29uc3VtZXIiLCJJbm5lckJ1dHRvbiIsInBsYWNlaG9sZGVyIiwiZGVmYXVsdFN0eWxlIiwib3B0aW9ucyIsImRpc3BsYXlFcnJvcnMiLCJBdXRob3JpemF0aW9uIiwiYXV0aCIsInN0eWxlcyIsImJhY2tncm91bmRJbWFnZSIsIl9nZXRCYWNrZ3JvdW5kSW1nIiwidW5kZWZpbmVkIiwic3R5bGUiLCJvbkNsaWNrIiwiY2xhc3NOYW1lIiwiY2hpbGRyZW4iLCJHb29nbGVCdXR0b24iLCJjYWxsYmFjayIsInJlc3BvbnNlU3RhdGUiLCJpc0F1dGhlbnRpY2F0ZWQiLCJzZXJ2ZXJSZXNwb25zZVN0YXRlIiwic2V0U2VydmVyUmVzcG9uc2VTdGF0ZSIsImN1cnJlbnRVcmwiLCJVUkxTZWFyY2hQYXJhbXMiLCJxdWVyeVBhcmFtc0NvZGUiLCJxdWVyeVBhcmFtc0Vycm9yIiwia2V5cyIsIm1lcmdlZFByb3BzQW5kU3RhdGVPcHRpb25zIiwiX2lubmVyIiwic2VydmVyUmVzcG9uc2VQcm9wcyIsImVtYWlsIiwiY2xpZW50X2lkIiwicHJvbXB0VHlwZSIsIkdvb2dsZUF1dGgiLCJfcHJvdmlkZXJQcm9wcyJdLCJtYXBwaW5ncyI6IjJCQUNFLElBQUlBLEVBQW1CLEdBR3ZCLFNBQVNDLEVBQW9CQyxHQUc1QixHQUFHRixFQUFpQkUsR0FDbkIsT0FBT0YsRUFBaUJFLEdBQVVDLFFBR25DLElBQUlDLEVBQVNKLEVBQWlCRSxHQUFZLENBQ3pDRyxFQUFHSCxFQUNISSxHQUFHLEVBQ0hILFFBQVMsSUFVVixPQU5BSSxFQUFRTCxHQUFVTSxLQUFLSixFQUFPRCxRQUFTQyxFQUFRQSxFQUFPRCxRQUFTRixHQUcvREcsRUFBT0UsR0FBSSxFQUdKRixFQUFP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QUFtQyxtQkFBa0JZLEtBQXBEMkYsRUFBZSxLQUFFekIsRUFBYSxLQUMvQixFQUF3QixxQkFBdkJVLEVBQU8sS0FBRVQsRUFBVSxLQUVwQnVDLEVBQThCLENBQ2hDZixnQkFBZSxFQUNmekIsY0FBYSxFQUNid0IsY0FBYSxFQUNidEcsaUJBQWdCLEVBQ2hCd0YsUUFBTyxFQUNQVCxXQUFVLEVBQ1ZDLFVBQVdBLEVBQVVELEVBQVlTLElBRXJDLE9BQ0ksa0JBQUNQLEVBQWtCLENBQUNqSCxNQUFPc0osR0FDdEJySSxFQUFNa0giLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMSk7XG4iLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJyZWFjdFwiKTsiLCIvKiogQGludGVybmFsICovXG5pbXBvcnQge0Rpc3BhdGNoLCBTZXRTdGF0ZUFjdGlvbiwgdXNlRWZmZWN0fSBmcm9tIFwicmVhY3RcIjtcblxuZXhwb3J0IGludGVyZmFjZSBJUGF5bG9hZCB7XG4gICAgcmVhZG9ubHkgY29kZTogc3RyaW5nO1xuICAgIHJlYWRvbmx5IHNjb3BlOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjb25zdCBHT09HTEVfT0FVVEgyX0VYQ0hBTkdFX1RPS0VOX1VSTCA9IFwiaHR0cHM6Ly9vYXV0aDIuZ29vZ2xlYXBpcy5jb20vdG9rZW5cIjtcblxuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IGludGVyZmFjZSBJQXBpUmVzcG9uc2VEYXRhIHsgcmVhZG9ubHkgYWNjZXNzX3Rva2VuOiBzdHJpbmc7IH1cbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwb3N0VG9FeGNoYW5nZUFwaVVybChhcGlVcmw6IHN0cmluZywgcGF5bG9hZDogSVBheWxvYWQpOiBQcm9taXNlPElBcGlSZXNwb25zZURhdGE+IHtcbiAgICBjb25zdCByZXM6IFJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYXBpVXJsLCB7XG4gICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgICB9LFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShwYXlsb2FkKSxcbiAgICB9KTtcbiAgICByZXR1cm4gcmVzLmpzb24oKTtcbn1cbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCBpbnRlcmZhY2UgSVNlcnZlclJlc3BvbnNlU3RhdGUgeyByZWFkb25seSBhY2Nlc3NUb2tlbj86IHN0cmluZzsgZXJyb3I/OiBzdHJpbmd9XG4vKiogQGludGVybmFsICovXG5leHBvcnQgaW50ZXJmYWNlIElTZXJ2ZXJSZXNwb25zZVByb3BzIHtcbiAgICByZWFkb25seSBjb2RlOiBzdHJpbmc7XG4gICAgcmVhZG9ubHkgc2NvcGU6IHN0cmluZztcbiAgICByZWFkb25seSBhcGlVcmw6IHN0cmluZztcbiAgICByZXNwb25zZVN0YXRlOiBJU2VydmVyUmVzcG9uc2VTdGF0ZTtcbiAgICBzZXRSZXNwb25zZVN0YXRlOiBEaXNwYXRjaDxTZXRTdGF0ZUFjdGlvbjxJU2VydmVyUmVzcG9uc2VTdGF0ZT4+O1xufVxuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNlcnZlclJlc3BvbnNlKHByb3BzOiBJU2VydmVyUmVzcG9uc2VQcm9wcyk6IHZvaWQge1xuICAgIGNvbnN0IHsgY29kZSwgYXBpVXJsLCBzY29wZSB9ID0gcHJvcHM7XG4gICAgY29uc3QgcGF5bG9hZDogSVBheWxvYWQgPSB7IGNvZGUsIHNjb3BlIH07XG4gICAgcG9zdFRvRXhjaGFuZ2VBcGlVcmwoYXBpVXJsLCBwYXlsb2FkKVxuICAgICAgICAudGhlbigoZGF0YTogSUFwaVJlc3BvbnNlRGF0YSkgPT4ge1xuICAgICAgICAgICAgLy8gdXBkYXRlIHJlc3BvbnNlU3RhdGUgYWNjZXNzVG9rZW5cbiAgICAgICAgICAgIGlmKCEoXCJhY2Nlc3NfdG9rZW5cIiBpbiBkYXRhKSkge1xuICAgICAgICAgICAgICAgIHByb3BzLnNldFJlc3BvbnNlU3RhdGUoe1xuICAgICAgICAgICAgICAgICAgICBlcnJvcjogXCJzbyBhY2Nlc3NfdG9rZW4gaW4gcmVzcG9uc2UgZGF0YSFcIixcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcHJvcHMuc2V0UmVzcG9uc2VTdGF0ZSh7XG4gICAgICAgICAgICAgICAgICAgIGFjY2Vzc1Rva2VuOiBkYXRhLmFjY2Vzc190b2tlbixcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goZXJyID0+IHtcbiAgICAgICAgICAgIHByb3BzLnNldFJlc3BvbnNlU3RhdGUoe1xuICAgICAgICAgICAgICAgIGVycm9yOiBlcnIubWVzc2FnZSxcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pO1xufVxuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IGZ1bmN0aW9uIHN0b3JlQWNjZXNzVG9rZW4odG9rZW46IHN0cmluZyk6IHZvaWQge1xuICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJhY2Nlc3NUb2tlblwiLCB0b2tlbik7XG59XG5cbi8qKlxuICogQGV4YW1wbGVcbiAqIGBgYFxuICogIGlmKGlzTG9nZ2VkSW4oKSkgeyAvLyByZXR1cm5zIHRydWUgaXMgYWNjZXNzVG9rZW4gZXhpc3RzIGluIExvY2FsU3RvcmFnZVxuICogICAgICAvLyB1c2VyIGxvZ2dlZCBjb2RlLi4uXG4gKiAgfVxuICogYGBgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0xvZ2dlZEluKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiAhIXdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImFjY2Vzc1Rva2VuXCIpO1xufVxuXG4vKipcbiAqIEBleGFtcGxlXG4gKiBgYGBcbiAqICBsb2dPdXRPQXV0aFVzZXIoKSAvLyByZW1vdmVzIHRoZSBhY2Nlc3NUb2tlbiBmcm9tIExvY2FsU3RvcmFnZVxuICogYGBgXG4gKiBAcmV0dXJuIHZvaWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxvZ091dE9BdXRoVXNlcigpOiB2b2lkIHtcbiAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oXCJhY2Nlc3NUb2tlblwiKTtcbn1cblxuLyoqXG4gKiBAZGVzY3JpcHRpb24gR2V0IHRoZSBzdG9yZWQgYWNjZXNzVG9rZW5cbiAqIEByZXR1cm4gVGhlIEFjY2VzcyBUb2tlbiBvciBub25lXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRBY2Nlc3NUb2tlbigpOiBzdHJpbmcgfCBudWxsIHtcbiAgICByZXR1cm4gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiYWNjZXNzVG9rZW5cIik7XG59XG5cbi8qKlxuICogQGRlc2NyaXB0aW9uIFdhcm5pbmc6IFBsZWFzZSBtYWtlIHN1cmUgdGhhdCBhcyBvZiB2ZXJzaW9uIGAwLjAuMjNgIHdlIGhhdmUgcmVtb3ZlZFxuICogdGhlIGBhcHBsaWNhdGlvbi9qc29uYCBjb250ZW50IHR5cGUgaGVhZGVycyBmcm9tIHRoaXMgZnVuY3Rpb24uIFRoaXMgbWF5IGNhdXNlIGFuIGlzc3VlXG4gKiBpZiB5b3Ugb3JpZ2luYWxseSBkaWRuJ3QgY29uc3RydWN0IHlvdXIgcmVxdWVzdCBjb250ZW50IHR5cGUgaGVhZGVycyB3aXRoIGBhcHBsaWNhdGlvbi9qc29uYC5cbiAqIEBleGFtcGxlXG4gKiBgYGBcbiAqICBmZXRjaCh1cmwsIHtcbiAqICAgICAgaGVhZGVyczogY3JlYXRlT0F1dGhIZWFkZXJzKCksXG4gKiAgfSlcbiAqIGBgYFxuICpcbiAqIElmIHlvdSByZXF1aXJlIHlvdXIgc2VydmVyIHRvIGhhbmRsZSBhdXRoZW50aWNhdGluZyBtdWx0aXBsZSB1c2VycyBhY3Jvc3MgbWFueSByZXNvdXJjZXNcbiAqIChvciB0YWJsZXMpIHRoZW4gcGFzcyBpbiB0aGUgbmFtZSBvZiB0aGUgcmVzb3VyY2UsIGZvciBFeGFtcGxlOlxuICogQGV4YW1wbGVcbiAqIGBgYFxuICogIGZldGNoKHVybCwge1xuICogICAgICBoZWFkZXJzOiBjcmVhdGVPQXV0aEhlYWRlcnMoXCJ1c2Vyc1wiKSxcbiAqICB9KVxuICogYGBgXG4gKlxuICogIFdpdGggdGhlIHJlc291cmNlIHZhbHVlLCB0aGUgZm9sbG93aW5nIGhlYWRlcnMgYXJlIGNvbnN0cnVjdGVkOlxuICpcbiAqICBAZXhhbXBsZVxuICogIGBgYFxuICogIHtcbiAqICAgIFwiWC1BdXRoLVRva2VuXCIgOiBcIjxUT0tFTj5cIixcbiAqICAgIFwiWC1BdXRoLVJlc291cmNlXCI6IFwidXNlcnNcIixcbiAqICB9XG4gKiAgYGBgXG4gKiBAcGFyYW0gcmVzb3VyY2UgT3B0aW9uYWwgcmVzb3VyY2UgbmFtZSB0byBsb29rIHVwIG9uIHRoZSBzZXJ2ZXJcbiAqIEByZXR1cm4gT2JqZWN0c1xuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlT0F1dGhIZWFkZXJzKHJlc291cmNlPzogc3RyaW5nKTogeyBbazogc3RyaW5nXTogc3RyaW5nIH0ge1xuICAgIGxldCByZXNvdXJjZUhlYWRlcnMgPSB7fTtcbiAgICBpZihyZXNvdXJjZSkge1xuICAgICAgICByZXNvdXJjZUhlYWRlcnMgPSB7XG4gICAgICAgICAgICBcIlgtQXV0aC1SZXNvdXJjZVwiOiByZXNvdXJjZSxcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICAuLi5yZXNvdXJjZUhlYWRlcnMsXG4gICAgICAgIFwiWC1BdXRoLVRva2VuXCI6IGBCZWFyZXIgJHtnZXRBY2Nlc3NUb2tlbigpfWAsXG4gICAgfVxufVxuXG4vKiogQGludGVybmFsICovXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlT0F1dGhRdWVyeVBhcmFtcygpOiB2b2lkIHtcbiAgICBjb25zdCBjdXJyZW50TG9jYXRpb24gPSBkb2N1bWVudC5sb2NhdGlvbi5ocmVmO1xuICAgIGlmKGRvY3VtZW50LmxvY2F0aW9uLnNlYXJjaCkge1xuICAgICAgICBjb25zdCBjbGVhbl91cmkgPSBjdXJyZW50TG9jYXRpb24uc3Vic3RyaW5nKDAsIGN1cnJlbnRMb2NhdGlvbi5pbmRleE9mKFwiP1wiKSk7XG4gICAgICAgIHdpbmRvdy5oaXN0b3J5LnJlcGxhY2VTdGF0ZSh7fSwgZG9jdW1lbnQudGl0bGUsIGNsZWFuX3VyaSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBkZXNjcmlwdGlvblxuICogRnVuY3Rpb24gdG8gZXhjaGFuZ2UgYSByZWZyZXNoIHRva2VuIGZvciBhbiBhY2Nlc3MgdG9rZW4gJiBzZXRzIHRoZSBhY2Nlc3NcbiAqIHRva2VuIGludG8gbG9jYWwgc3RvcmFnZS4uXG4gKiBAZXhhbXBsZVxuICogYGBgXG4gKiAgZXhjaGFuZ2VUb2tlbihDTElFTlRfSUQsIFJFRlJFU0hfVE9LRU4sIENMSUVOVF9TRUNSRVQpXG4gKiAgLnRoZW4oYWNjZXNzVG9rZW4gPT4ge1xuICogICAgICAgY29uc29sZS5sb2coYWNjZXNzVG9rZW4pIC8vIHlvdXIgYWNjZXNzIHRva2VuLi4uXG4gKiAgIH0pO1xuICogYGBgXG4gKiBJZiB5b3UgcmVxdWlyZSBhbiBhY2Nlc3MgdG9rZW4gdG8gcnVuIHlvdXIgZTJlIHRlc3RzIHRoZW4gYGV4Y2hhbmdlVG9rZW5gIHdpbGwgc2V0IGFuZCByZXR1cm4gYSBuZXcgYWNjZXNzIHRva2VuLlxuICogQGV4YW1wbGVcbiAqIGBgYFxuICogICAgIEN5cHJlc3MuQ29tbWFuZHMuYWRkKFwibG9naW5TU09cIiwgIChvdmVycmlkZXMgPSB7fSkgPT4ge1xuICogICAgICAgQ3lwcmVzcy5sb2coe1xuICogICAgICAgICAgIFwibmFtZVwiOiBcImxvZ2luU1NPXCIsXG4gKiAgICAgICB9KTtcbiAqICAgICAgIGlmKCFnZXRBY2Nlc3NUb2tlbigpKSB7XG4gKiAgICAgICAgICAgZXhjaGFuZ2VUb2tlbihDTElFTlRfSUQsIFJFRlJFU0hfVE9LRU4sIENMSUVOVF9TRUNSRVQpXG4gKiAgICAgICAgICAgLnRoZW4oYWNjZXNzVG9rZW4gPT4ge1xuICogICAgICAgICAgICAgICBjeS5yZXF1ZXN0KHtcbiAqICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gKiAgICAgICAgICAgICAgICAgICB1cmw6IGAke0FQSV9VUkx9L3N0YWZmYCxcbiAqICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IGNyZWF0ZU9BdXRoSGVhZGVycygpLFxuICogICAgICAgICAgICAgICB9KTtcbiAqICAgICAgICAgICB9KTtcbiAqICAgICAgIH1cbiAqICAgfSk7XG4gKiBgYGBcbiAqIEBwYXJhbSBjbGllbnRJZCBHb29nbGUgT0F1dGggQ2xpZW50IElEXG4gKiBAcGFyYW0gcmVmcmVzaFRva2VuIFJlZnJlc2ggVG9rZW4gKFVzZSBHb29nbGUgT2F1dGggUGxheWdyb3VuZCB0byBnZW5lcmF0ZSBhIHJlZnJlc2ggdG9rZW4pXG4gKiBTZWU6IGh0dHBzOi8vZGV2ZWxvcGVycy5nb29nbGUuY29tL29hdXRocGxheWdyb3VuZC9cbiAqIEBwYXJhbSBjbGllbnRTZWNyZXQgR29vZ2xlIEFwaSdzIENsaWVudCBTZWNyZXRcbiAqIEByZXR1cm4gUHJvbWlzZTxTdHJpbmc+IFRoZSBzdHJpbmcgaXMgdGhlIG5ldyBhY2Nlc3MgdG9rZW4gYWxzbyBzZXQgaW4gbG9jYWwgc3RvcmFnZVxuICovXG5leHBvcnQgZnVuY3Rpb24gZXhjaGFuZ2VUb2tlbihjbGllbnRJZDogc3RyaW5nLCByZWZyZXNoVG9rZW46IHN0cmluZywgY2xpZW50U2VjcmV0OiBzdHJpbmcpOiBQcm9taXNlPFN0cmluZz4ge1xuICAgIGxldCB1cmwgPSBgJHtHT09HTEVfT0FVVEgyX0VYQ0hBTkdFX1RPS0VOX1VSTH0/YDtcbiAgICB1cmwgKz0gYGNsaWVudF9pZD0ke2NsaWVudElkfWA7XG4gICAgdXJsICs9IGAmZ3JhbnRfdHlwZT1yZWZyZXNoX3Rva2VuYDtcbiAgICB1cmwgKz0gYCZyZWZyZXNoX3Rva2VuPSR7cmVmcmVzaFRva2VufWA7XG4gICAgdXJsICs9IGAmY2xpZW50X3NlY3JldD0ke2NsaWVudFNlY3JldH1gO1xuICAgIHJldHVybiBmZXRjaCh1cmwsIHsgbWV0aG9kOiBcIlBPU1RcIiwgfSlcbiAgICAgICAgLnRoZW4oZGF0YSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gZGF0YS5qc29uKCkudGhlbihkYXRhID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5lcnJvcikge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZGF0YS5lcnJvcik7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiYWNjZXNzVG9rZW5cIiwgZGF0YS5hY2Nlc3NfdG9rZW4pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YS5hY2Nlc3NfdG9rZW47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaChlcnIgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5kZWJ1ZyhlcnIpXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgdG8gcmVmcmVzaCBhY2Nlc3MgdG9rZW5cIik7XG4gICAgICAgIH0pO1xufVxuIiwiLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IGVudW0gR29vZ2xlQVBJQ29ubmVjdGlvblN0cmluZ3Mge1xuICAgIEdPT0dMRV9PQVVUSF9FTkRQT0lOVCA9IFwiaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tL28vb2F1dGgyL3YyL2F1dGhcIixcbn1cbi8qKiBAcHVibGljICovXG5leHBvcnQgdHlwZSBUeXBlUHJvbXB0ID0gXCJjb25zZW50XCIgfCBcInNlbGVjdF9hY2NvdW50XCI7XG4vKiogQHB1YmxpYyAqL1xuaW50ZXJmYWNlIElBdXRob3JpemF0aW9uQmFzZSB7XG4gICAgLyoqIFRoaXMgaXMgeW91ciBjbGllbnQgSUQgKi9cbiAgICBjbGllbnRJZDogc3RyaW5nO1xuICAgIC8qKiBXaGVyZSB5b3UgUmVhY3QgYXBwIHNob3VsZCByZWRpcmVjdCB0byBpZiB1c2VyIGhhcyBzdWNjZXNzZnVsbHkgbG9nZ2VkIGluICoqL1xuICAgIHJlZGlyZWN0VXJpOiBzdHJpbmc7XG4gICAgLyoqIEJ5IGRlZmF1bHQgdGhpcyBpcyBzZXQgdG8gKmNvZGUqICovXG4gICAgcmVzcG9uc2VUeXBlPzogc3RyaW5nO1xuICAgIC8qKlxuICAgICAqIEluZGljYXRlcyBpZiB0aGUgYXBpICoqYXBpVXJsKioge0BsaW5rIElHb29nbGVCdXR0b259IGNhbiByZWZyZXNoIHRva2VucyBvbiB0aGUgdXNlcidzXG4gICAgICogYmVoYWxmLiBUaGUgZGVmYXVsdCB2YWx1ZSBpcyAqb25saW5lKiBidXQgaWYgeW91ciBiYWNrZW5kIGFwaSB3aWxsIHJlZnJlc2ggdGhlIHRva2VuIHRoZW5cbiAgICAgKiB5b3UgbXVzdCBwYXNzIGluIGEgc3RyaW5nIHZhbHVlIG9mICpvZmZsaW5lKiAoVGhpcyBpcyByZWNvbW1lbmRlZCBmb3IgcmVhY3QgYXBwcyBjb25uZWN0ZWRcbiAgICAgKiB0byBhIFJFU1QgYXBpIGJhY2tlbmQpLlxuICAgICAqL1xuICAgIGFjY2Vzc1R5cGU/OiBzdHJpbmc7XG4gICAgLyoqXG4gICAgICogVGhpcyBvcHRpb24gaXMgY3VycmVudGx5IHVuYXZhaWxhYmxlIGJ1dCB3aWxsIGJlIGluIGEgYWRkZWQgaW4gYSBmdXR1cmUgdmVyc2lvbixcbiAgICAgKiBUT0RPIC0gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9qb2VnYXNld2ljei9yZWFjdC1nb29nbGUtb2F1dGgyLjAvaXNzdWVzLzNcbiAgICAgKiAqL1xuICAgIHN0YXRlPzogc3RyaW5nO1xuICAgIC8qKlxuICAgICAqIERlZmF1bHRlZCB0byB0cnVlLiBBbnkgZXh0cmEgc2NvcGVzIHRoZSBsb2dnZWQgaW4gdXNlciBwcmV2aW91c2x5IGdyYW50ZWRcbiAgICAgKiB3aWxsIGJlIGF2YWlsYWJsZSB3aXRoaW4gdGhlIG5ldyBhY2Nlc3MgdG9rZW4uXG4gICAgICogKi9cbiAgICBpbmNsdWRlR3JhbnRlZFNjb3Blcz86IGJvb2xlYW47XG4gICAgLyoqIE5vdCByZXF1aXJlZCwgb3B0aW9uYWwuIEZvciBwcmVmaWxsaW5nIGVtYWlsIGZpZWxkcyAqL1xuICAgIGxvZ2luSGludD86IHN0cmluZztcbiAgICAvKipcbiAgICAgKiBOb3QgcmVxdWlyZWQsIG9wdGlvbmFsLiBBIHNwYWNlLWRlbGltaXRlZCwgY2FzZS1zZW5zaXRpdmUgbGlzdCBvZiBwcm9tcHRzIHRvXG4gICAgICogcHJlc2VudCB0aGUgdXNlci4gSWYgeW91IGRvbid0IHNwZWNpZnkgdGhpcyBwYXJhbWV0ZXIsIHRoZSB1c2VyIHdpbGwgYmUgcHJvbXB0ZWRcbiAgICAgKiBvbmx5IHRoZSBmaXJzdCB0aW1lIHlvdXIgcHJvamVjdCByZXF1ZXN0cyBhY2Nlc3MuIFZhbGlkIHZhbHVlczpcbiAgICAgKiAgY29uc2VudCAtIFByb21wdCB0aGUgdXNlciBmb3IgY29uc2VudC5cbiAgICAgKiAgc2VsZWN0X2FjY291bnQgLSBQcm9tcHQgdGhlIHVzZXIgdG8gc2VsZWN0IGFuIGFjY291bnQuXG4gICAgICogKi9cbiAgICBwcm9tcHQ/OiBUeXBlUHJvbXB0O1xufVxuLyoqIEBwdWJsaWMgKi9cbmV4cG9ydCBpbnRlcmZhY2UgSUF1dGhvcml6YXRpb25PcHRpb25zIGV4dGVuZHMgSUF1dGhvcml6YXRpb25CYXNlIHtcbiAgICBzY29wZXM6IEFycmF5PHN0cmluZz47XG59XG4vKiogQGludGVybmFsICovXG5leHBvcnQgaW50ZXJmYWNlIElBdXRob3JpemF0aW9uIHtcbiAgICBwYXJhbXM6IElBdXRob3JpemF0aW9uT3B0aW9ucztcbiAgICAvKiogU2V0IHRvICBgW1wib3BlbmlkXCIsIFwicHJvZmlsZVwiXWAgYnkgZGVmYXVsdCAqKi9cbiAgICBzY29wZXNTdHI6IHN0cmluZztcbn1cbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCBjbGFzcyBBdXRob3JpemF0aW9uIGltcGxlbWVudHMgSUF1dGhvcml6YXRpb24ge1xuXG4gICAgcHJpdmF0ZSBfZ29vZ2xlUmVkaXJlY3RVUkw/OiBzdHJpbmc7XG5cbiAgICBwdWJsaWMgcGFyYW1zOiBJQXV0aG9yaXphdGlvbk9wdGlvbnM7XG5cbiAgICBwdWJsaWMgc2NvcGVzU3RyOiBzdHJpbmc7XG5cbiAgICBjb25zdHJ1Y3RvcihwYXJhbXM6IElBdXRob3JpemF0aW9uT3B0aW9ucywgc2NvcGVzU3RyOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy5wYXJhbXMgPSBwYXJhbXM7XG4gICAgICAgIHRoaXMuc2NvcGVzU3RyID0gc2NvcGVzU3RyO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBpbnRlcm5hbFxuICAgICAqIEBwcm9wZXJ0eSBnb29nbGVSZWRpcmVjdFVSTCBBY2Nlc3MgdGhlIHVybCBmb3IgdGhlIGluaXRpYWxcbiAgICAgKiBicm93c2VyIGNhbGwgdG8gR29vZ2xlJ3MgT0F1dGggMi4wIHNlcnZlci4gVXNlZnVsIGZvciBkZWJ1Z2dpbmcuXG4gICAgICovXG4gICAgcHVibGljIGdldCBnb29nbGVSZWRpcmVjdFVSTCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2dvb2dsZVJlZGlyZWN0VVJMO1xuICAgIH1cblxuICAgIHB1YmxpYyBzZXQgZ29vZ2xlUmVkaXJlY3RVUkwodmFsdWU6IHN0cmluZyB8IHVuZGVmaW5lZCkge1xuICAgICAgICB0aGlzLl9nb29nbGVSZWRpcmVjdFVSTCA9IHZhbHVlO1xuICAgIH1cblxuICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICBwdWJsaWMgY3JlYXRlQXV0aG9yaXphdGlvblJlcXVlc3RVUkwoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHtcbiAgICAgICAgICAgIGFjY2Vzc1R5cGUgPSBcIm9mZmxpbmVcIixcbiAgICAgICAgICAgIGluY2x1ZGVHcmFudGVkU2NvcGVzID0gdHJ1ZSxcbiAgICAgICAgICAgIHJlc3BvbnNlVHlwZSA9IFwiY29kZVwiLFxuICAgICAgICAgICAgc3RhdGUgPSBudWxsLFxuICAgICAgICAgICAgcmVkaXJlY3RVcmksXG4gICAgICAgICAgICBjbGllbnRJZCxcbiAgICAgICAgICAgIGxvZ2luSGludCxcbiAgICAgICAgICAgIHByb21wdCxcbiAgICAgICAgfSA9IHRoaXMucGFyYW1zO1xuICAgICAgICBjb25zdCBkb21haW4gPSBHb29nbGVBUElDb25uZWN0aW9uU3RyaW5ncy5HT09HTEVfT0FVVEhfRU5EUE9JTlQ7XG4gICAgICAgIGxldCB1cmw6IHN0cmluZztcbiAgICAgICAgdXJsID0gYCR7ZG9tYWlufT9zY29wZT0ke3RoaXMuc2NvcGVzU3RyfSZgO1xuICAgICAgICB1cmwgPSBhY2Nlc3NUeXBlID8gYCR7dXJsfWFjY2Vzc190eXBlPSR7YWNjZXNzVHlwZX0mYCA6IHVybDtcbiAgICAgICAgdXJsID0gYCR7dXJsfWluY2x1ZGVfZ3JhbnRlZF9zY29wZXM9JHtpbmNsdWRlR3JhbnRlZFNjb3Blc30mYDtcbiAgICAgICAgdXJsID0gYCR7dXJsfXJlc3BvbnNlX3R5cGU9JHtyZXNwb25zZVR5cGV9JmA7XG4gICAgICAgIHVybCA9IHN0YXRlID8gYCR7dXJsfXN0YXRlPSR7c3RhdGV9JmAgOiB1cmw7XG4gICAgICAgIHVybCA9IGxvZ2luSGludCA/IGAke3VybH1sb2dpbl9oaW50PSR7bG9naW5IaW50fSZgIDogdXJsO1xuICAgICAgICB1cmwgPSBwcm9tcHQgPyBgJHt1cmx9cHJvbXB0PSR7cHJvbXB0fSZgIDogdXJsO1xuICAgICAgICB1cmwgPSBgJHt1cmx9cmVkaXJlY3RfdXJpPSR7cmVkaXJlY3RVcml9JmA7XG4gICAgICAgIHVybCA9IGAke3VybH1jbGllbnRfaWQ9JHtjbGllbnRJZH1gO1xuICAgICAgICB0aGlzLmdvb2dsZVJlZGlyZWN0VVJMID0gdXJsO1xuICAgIH1cblxuICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICBwdWJsaWMgc3RhdGljIGNyZWF0ZVNjb3BlcyhzY29wZXM6IEFycmF5PHN0cmluZz4pOiBzdHJpbmcge1xuICAgICAgICBsZXQgc3RyID0gXCJcIjtcbiAgICAgICAgc2NvcGVzLm1hcCgoc2NvcGUsIGkpID0+IHtcbiAgICAgICAgICAgIGlmIChzY29wZXMubGVuZ3RoIC0gMSA9PT0gaSkge1xuICAgICAgICAgICAgICAgIHN0ciArPSBgJHtzY29wZX1gO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzdHIgKz0gYCR7c2NvcGV9JTIwYDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBzdHI7XG4gICAgfVxuXG4gICAgLyoqIEBpbnRlcm5hbCAqL1xuICAgIHB1YmxpYyByZWRpcmVjdCA9IChlOiBhbnkpOiB2b2lkID0+IHtcbiAgICAgICAgaWYodGhpcy5nb29nbGVSZWRpcmVjdFVSTCkge1xuICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlcGxhY2UodGhpcy5nb29nbGVSZWRpcmVjdFVSTClcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcIkVycm9yIGNyZWF0aW5nIHJlZGlyZWN0IHVybCB0byBHb29nbGUncyBhdXRob3JpemF0aW9uIHNlcnZlclwiKTtcbiAgICAgICAgfVxuICAgIH1cbn0iLCJpbXBvcnQge2RlZmF1bHQgYXMgUmVhY3QsIERpc3BhdGNoLCBTZXRTdGF0ZUFjdGlvbiwgdXNlQ29udGV4dCwgdXNlRWZmZWN0LCB1c2VTdGF0ZX0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQge1xuICAgIEF1dGhvcml6YXRpb24sXG4gICAgSUF1dGhvcml6YXRpb25PcHRpb25zLCBUeXBlUHJvbXB0LFxufSBmcm9tIFwiLi9hdXRob3JpemF0aW9uXCI7XG5pbXBvcnQge1xuICAgIHNlcnZlclJlc3BvbnNlLFxuICAgIHN0b3JlQWNjZXNzVG9rZW4sXG4gICAgaXNMb2dnZWRJbixcbiAgICByZW1vdmVPQXV0aFF1ZXJ5UGFyYW1zLCBJU2VydmVyUmVzcG9uc2VTdGF0ZSwgSVNlcnZlclJlc3BvbnNlUHJvcHMsXG59IGZyb20gXCIuL2FwaVV0aWxzXCI7XG5cbi8qKiBAcHVibGljICovXG5leHBvcnQgaW50ZXJmYWNlIElHb29nbGVCdXR0b24ge1xuICAgIC8qKiBQbGFjZWhvbGRlciBpbWFnZSBkaXNwbGF5ZWQgbmV4dCB0byBidXR0b24gdGV4dC4gVGhlIHBsYWNlaG9sZGVyIHByb3AgaGFzIG5vIGVmZmVjdCBpZiBwbGFjZWhvbGRlciBpcyBzZXQgdG8gZmFsc2UgKi9cbiAgICByZWFkb25seSBwbGFjZWhvbGRlcj86IHN0cmluZztcbiAgICAvKiogUmVtb3ZlIGRlZmF1bHQgc3R5bGVzLlxuICAgICAqICBUbyBTdHlsZSB0aGUgPGJ1dHRvbj4gZWxlbWVudCB3aXRoIENTUywgdXNlIGBnb29nbGUtb2F1dGgtYnRuYC4gRm9yIGV4YW1wbGU6XG4gICAgICogIGBgYFxuICAgICAqICAuZ29vZ2xlLW9hdXRoLWJ0biB7XG4gICAgICogICAgICBjb2xvcjogcmVkO1xuICAgICAqICAgICAgYmFja2dyb3VuZC1jb2xvcjogbGltZTtcbiAgICAgKiAgfVxuICAgICAqICBgYGBcbiAgICAgKiAoeW91IGNhbiBhbHNvIHBhc3MgeW91ciBjc3Mgc2VsZWN0b3JzIGRpcmVjdGx5IHdpdGggUmVhY3RzJyBgY2xhc3NOYW1lYCBwcm9wKVxuICAgICAqICovXG4gICAgcmVhZG9ubHkgZGVmYXVsdFN0eWxlPzogYm9vbGVhbjtcbiAgICAvKiogU2VlIElBdXRob3JpemF0aW9uUmVxdWVzdFBhcmFtcyAqL1xuICAgIHJlYWRvbmx5IG9wdGlvbnM6IElBdXRob3JpemF0aW9uT3B0aW9ucztcbiAgICAvKipcbiAgICAgKiBAcHJvcGVydHlcbiAgICAgKiBAb3B0aW9uYWxcbiAgICAgKiBBIFJlYWN0IGNvbXBvbmVudCBvciBhbnkgZnVuY3Rpb24gdGhhdCByZXR1cm5zIGEgUmVhY3QgY29tcG9uZW50LlxuICAgICAqIFRoaXMgd291bGQgbm9ybWFsbHkgYmUgdXNlZCB0byBkaXNwbGF5IGEgcHJlbG9hZGVyIHRvIHRoZSB1c2VyIHdoaWxzdFxuICAgICAqIHRoZSBPQXV0aDIuMCBsb2dpbiBzdHJhdGVneSBpcyBpbiBmbGlnaHQuIEJ5IGRlZmF1bHQgYSBgTG9hZGluZy4uLmBcbiAgICAgKiBtZXNzYWdlIHdpbGwgYmUgZGlzcGxheWVkLlxuICAgICAqIEBleGFtcGxlXG4gICAgICogYGBgXG4gICAgICogPEdvb2dsZUJ1dHRvblxuICAgICAqICAgIGNhbGxiYWNrPXsoKSA9PiA8PlwiTG9hZGluZy4uLlwiPC8+fVxuICAgICAqICAgIC8vIG90aGVyIHByb3BzLi4uXG4gICAgICogLz5cbiAgICAgKiBgYGBcbiAgICAgKi9cbiAgICByZWFkb25seSBjYWxsYmFjaz86ICgpID0+IFJlYWN0LlJlYWN0SFRNTEVsZW1lbnQ8YW55PjtcbiAgICAvKiogVGhlIHVybCBvZiB0aGUgYXBpIHRvIHBlcmZvcm0gdGhlIGV4Y2hhbmdlICovXG4gICAgcmVhZG9ubHkgYXBpVXJsOiBzdHJpbmc7XG4gICAgLyoqXG4gICAgICogT3B0aW9uYWwuIERlZmF1bHQgc2V0IHRvIGZhbHNlLlxuICAgICAqIERpc3BsYXkgYW4gZXJyb3IgdG8gdGhlIHVzZXIgKHdpbGwgYmUgZGlzcGxheWVkIGluIGEgY2hpbGQgYGRpdmAgZWxlbWVudCkuXG4gICAgICovXG4gICAgcmVhZG9ubHkgZGlzcGxheUVycm9ycz86IGJvb2xlYW47XG59XG4vKiogQGludGVybmFsICovXG50eXBlIFR5cGVCdXR0b25TdHlsZXMgPSB7IFtrZXk6IHN0cmluZ106IHN0cmluZyB9O1xuLyoqIEBpbnRlcm5hbCAqL1xudHlwZSBUeXBlR29vZ2xlQnV0dG9uID0gSUdvb2dsZUJ1dHRvbiAmIFJlYWN0LkJ1dHRvbkhUTUxBdHRyaWJ1dGVzPEhUTUxCdXR0b25FbGVtZW50Pjtcbi8qKiBAaW50ZXJuYWwgKi9cbmludGVyZmFjZSBJU2VydmVyUmVzcG9uc2Uge1xuICAgIHJlYWRvbmx5IGVtYWlsPzogc3RyaW5nO1xuICAgIGVycm9yPzogc3RyaW5nO1xuICAgIHJlYWRvbmx5IGNvZGU6IHN0cmluZztcbiAgICByZWFkb25seSBzY29wZTogc3RyaW5nO1xuICAgIHJlYWRvbmx5IGNsaWVudF9pZDogc3RyaW5nO1xuICAgIHJlYWRvbmx5IGFwaVVybDogc3RyaW5nO1xuICAgIHJlc3BvbnNlU3RhdGU6IElTZXJ2ZXJSZXNwb25zZVN0YXRlO1xuICAgIHNldFJlc3BvbnNlU3RhdGU6IERpc3BhdGNoPFNldFN0YXRlQWN0aW9uPElTZXJ2ZXJSZXNwb25zZVN0YXRlPj47XG59XG4vKiogQGludGVybmFsICovXG5jb25zdCBTRVJWRVJfUkVTUE9OU0VfU1RBVEUgPSB7IH07XG5cbi8qKiBAaW50ZXJuYWwgKi9cbmNvbnN0IGJ1dHRvblN0eWxpbmc6IFR5cGVCdXR0b25TdHlsZXMgPSB7XG4gICAgYmFja2dyb3VuZFNpemU6IFwiMjBweCAyMHB4XCIsXG4gICAgYmFja2dyb3VuZFJlcGVhdDogXCJuby1yZXBlYXRcIixcbiAgICBiYWNrZ3JvdW5kUG9zaXRpb246IFwiMTJweCAxMHB4XCIsXG4gICAgdGV4dEluZGVudDogXCIxOXB4XCIsXG4gICAgYm9yZGVyOiBcIjFweCBzb2xpZCAjYmRjM2M3XCIsXG4gICAgcGFkZGluZzogXCI5cHggMjNweFwiLFxuICAgIGJvcmRlclJhZGl1czogXCI5cHhcIixcbiAgICBiYWNrZ3JvdW5kQ29sb3I6IFwiI2JkYzNjN1wiLFxuICAgIGZvbnRTaXplOiBcIjE4cHhcIixcbn07XG5cbmV4cG9ydCBpbnRlcmZhY2UgSU9BdXRoU3RhdGUge1xuICAgIGlzQXV0aGVudGljYXRlZD86IGJvb2xlYW47XG4gICAgc2V0T0F1dGhTdGF0ZTogRnVuY3Rpb247XG4gICAgcmVzcG9uc2VTdGF0ZT86IElTZXJ2ZXJSZXNwb25zZVN0YXRlO1xuICAgIG9wdGlvbnM/OiBJQXV0aG9yaXphdGlvbk9wdGlvbnM7XG4gICAgc2V0T3B0aW9uczogRnVuY3Rpb247XG4gICAgc2V0UHJvbXB0OiBGdW5jdGlvbjtcbiAgICAvKipcbiAgICAgKiBgYGBcbiAgICAgKiAgICBpbXBvcnQge1xuICAgICAqICAgICAgIHJlc3BvbnNlU3RhdGVcbiAgICAgKiAgIH0gZnJvbSBcInJlYWN0LWdvb2dsZS1vYXV0aDJcIjtcbiAgICAgKlxuICAgICAqICAgPEdvb2dsZUF1dGg+XG4gICAgICogICB7KHtyZXNwb25zZVN0YXRlfSkgPT4ge1xuICAgICAqICAgICAgIC8vIGFjY2VzcyB0aGUgdG9rZW4gZnJvbSB0aGUgc3RhdGVcbiAgICAgKiAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZVN0YXRlLmFjY2Vzc1Rva2VuKSAvLyA8QUNDRVNTX1RPS0VOPlxuICAgICAqICAgfX1cbiAgICAgKiAgIDwvR29vZ2xlQXV0aD5cbiAgICAgKiBgYGBcbiAgICAgKi9cbiAgICBzZXRSZXNwb25zZVN0YXRlOiBEaXNwYXRjaDxTZXRTdGF0ZUFjdGlvbjxJU2VydmVyUmVzcG9uc2VTdGF0ZT4+O1xufVxuLyoqIEBpbnRlcm5hbCAqL1xuY29uc3QgREVGQVVMVF9HT09HTEVfQVVUSF9DT05URVhUID0ge1xuICAgIHNldE9BdXRoU3RhdGU6ICgpID0+IHt9LFxuICAgIHNldE9wdGlvbnM6ICgpID0+IHt9LFxuICAgIHNldFByb21wdDogKCkgPT4ge30sXG4gICAgc2V0UmVzcG9uc2VTdGF0ZTogKCkgPT4ge30sXG59O1xuLyoqIEBpbnRlcm5hbCAqL1xuY29uc3QgR29vZ2xlQXV0aENvbnRleHQgPSBSZWFjdC5jcmVhdGVDb250ZXh0PElPQXV0aFN0YXRlPihERUZBVUxUX0dPT0dMRV9BVVRIX0NPTlRFWFQpO1xuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IGNvbnN0IEdvb2dsZUF1dGhQcm92aWRlciA9IEdvb2dsZUF1dGhDb250ZXh0LlByb3ZpZGVyO1xuLyoqXG4gKiBAZXhhbXBsZVxuICogR2V0IG5vdGlmaWVkIHdoZW4gYSB1c2VyIGhhcyBsb2dnZWQgaW4gc3VjY2Vzc2Z1bGx5IGJ5IHdyYXBwaW5nIHRoZSBHb29nbGVCdXR0b25cbiAqIGNvbXBvbmVudCB3aXRoaW4gdGhlIEdvb2dsZUF1dGggcHJvdmlkZXIuIEZvciBleGFtcGxlOlxuICogYGBgXG4gKiAgICBpbXBvcnQge1xuICogICAgICAgR29vZ2xlQXV0aFxuICogICB9IGZyb20gXCJyZWFjdC1nb29nbGUtb2F1dGgyXCI7XG4gKlxuICogICA8R29vZ2xlQXV0aD5cbiAqICAgeyh7aXNBdXRoZW50aWNhdGVkfSkgPT4ge1xuICogICAgICAgLy8gaXNBdXRoZW50aWNhdGVkIHdpbGwgZ2V0IHNldCB0byB0cnVlIHdoZW4gYSB1c2VyIGhhcyBzdWNjZXNzZnVsbHkgbG9nZ2VkIGluLlxuICogICAgICAgY29uc29sZS5sb2coXCJ2YWx1ZTogXCIsIGlzQXV0aGVudGljYXRlZCk7IC8vIHZhbHVlOiB0cnVlIG9yIGZhbHNlXG4gKiAgICAgICByZXR1cm4gPEdvb2dsZUJ1dHRvblxuICogICAgICAgICAgICAgICAgIC8vIG9wdGlvbnMuLi5cbiAqICAgICAgICAgICAgICAgLz5cbiAqICAgfX1cbiAqICAgPC9Hb29nbGVBdXRoPlxuICogYGBgXG4gKi9cbmV4cG9ydCBjb25zdCBHb29nbGVBdXRoQ29uc3VtZXIgPSBHb29nbGVBdXRoQ29udGV4dC5Db25zdW1lcjtcbi8qKiBAaW50ZXJuYWwgKi9cbmNvbnN0IF9nZXRCYWNrZ3JvdW5kSW1nID0gKHBsYWNlaG9sZGVyOiBzdHJpbmcsIHN0eWxlczogVHlwZUJ1dHRvblN0eWxlcyk6IFR5cGVCdXR0b25TdHlsZXMgPT4ge1xuICAgIGlmKHBsYWNlaG9sZGVyKSB7XG4gICAgICAgIHJldHVybiB7IC4uLnN0eWxlcywgYmFja2dyb3VuZEltYWdlOiBgdXJsKCR7cGxhY2Vob2xkZXJ9KWAgfTtcbiAgICB9XG4gICAgcmV0dXJuIHN0eWxlcztcbn1cblxuLyoqIEBpbnRlcm5hbCAqL1xuaW50ZXJmYWNlIElJbm5lckJ1dHRvblByb3BzIGV4dGVuZHMgSUdvb2dsZUJ1dHRvbiB7XG4gICAgZXJyb3I/OiBzdHJpbmc7XG59XG4vKiogQGludGVybmFsICovXG5leHBvcnQgY29uc3QgSW5uZXJCdXR0b24gPSAocHJvcHM6IElJbm5lckJ1dHRvblByb3BzICYgUmVhY3QuQnV0dG9uSFRNTEF0dHJpYnV0ZXM8SFRNTEJ1dHRvbkVsZW1lbnQ+KSA9PiB7XG4gICAgY29uc3Qge1xuICAgICAgICBwbGFjZWhvbGRlciA9IFwiXCIsXG4gICAgICAgIGRlZmF1bHRTdHlsZSA9IHRydWUsXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIGRpc3BsYXlFcnJvcnMgPSBmYWxzZSxcbiAgICB9ID0gcHJvcHM7XG5cbiAgICBjb25zdCBzY29wZXMgPSBBdXRob3JpemF0aW9uLmNyZWF0ZVNjb3BlcyhvcHRpb25zLnNjb3Blcyk7XG4gICAgY29uc3QgYXV0aCA9IG5ldyBBdXRob3JpemF0aW9uKG9wdGlvbnMsIHNjb3Blcyk7XG4gICAgYXV0aC5jcmVhdGVBdXRob3JpemF0aW9uUmVxdWVzdFVSTCgpO1xuXG5cbiAgICBjb25zdCBzdHlsZXMgPSBkZWZhdWx0U3R5bGUgPyBfZ2V0QmFja2dyb3VuZEltZyhwbGFjZWhvbGRlciwgYnV0dG9uU3R5bGluZykgOiB1bmRlZmluZWQ7XG4gICAgaWYocHJvcHMuZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihgW1JlYWN0LUdvb2dsZS1PQXV0aDJdIEVycm9yOiAke3Byb3BzLmVycm9yfVxuICAgICAgICAgLSBUbyBkaXNwbGF5IHRoZSBlcnJvciB0byB0aGUgdXNlciwgc2V0IElHb29nbGVQcm9wcyBkaXNwbGF5RXJyb3JzIHRvIHRydWUuXG4gICAgICAgICBTZWUgaHR0cHM6Ly9qb2VnYXNld2ljei5naXRodWIuaW8vcmVhY3QtZ29vZ2xlLW9hdXRoMi4wL2ApO1xuICAgIH1cbiAgICByZW1vdmVPQXV0aFF1ZXJ5UGFyYW1zKCk7XG4gICAgcmV0dXJuIDw+XG4gICAgICAgIDxidXR0b24gc3R5bGU9e3N0eWxlc30gb25DbGljaz17YXV0aC5yZWRpcmVjdH0gY2xhc3NOYW1lPXtgJHtwcm9wcy5jbGFzc05hbWV9IGdvb2dsZS1vYXV0aC1idG5gfT57cHJvcHMuY2hpbGRyZW59PC9idXR0b24+XG4gICAgICAgIHsoZGlzcGxheUVycm9ycyAmJiBwcm9wcy5lcnJvcikgJiYgPGRpdj57cHJvcHMuZXJyb3J9PC9kaXY+fVxuICAgIDwvPlxufVxuLyoqXG4gKiBAZXhhbXBsZVxuICogKipRdWljayBTdGFydDoqKlxuICpcbiAqIEZpcnN0IGNyZWF0ZSBhbiBvcHRpb25zIG9iamVjdCB0aGF0IGltcGxlbWVudHMgYW4ge0BsaW5rICBJQXV0aG9yaXphdGlvbk9wdGlvbnN9IHR5cGUuXG4gKiBDaGVjayB0aGUge0BsaW5rICBJQXV0aG9yaXphdGlvbk9wdGlvbnN9IGFuZCB7QGxpbmsgIElBdXRob3JpemF0aW9uQmFzZX0gdHlwZXMgZm9yXG4gKiBhbGwgcmVxdWlyZWQgcHJvcGVydGllcy4gVGhlbiwgcGFzcyB0aGUgb3B0aW9ucyB0byB0aGUge0BsaW5rIEdvb2dsZUJ1dHRvbn0gY29tcG9uZW50LlxuICpcbiAqIGBgYFxuICogIGNvbnN0IG9wdGlvbnM6ICA9IHtcbiAqICAgICAgY2xpZW50SWQ6IChwcm9jZXNzLmVudi5DTElFTlRfSUQgYXMgc3RyaW5nKSxcbiAqICAgICAgIHJlZGlyZWN0VXJpOiBcImh0dHA6Ly9sb2NhbGhvc3Q6MzAwMFwiLFxuICogICAgICAgc2NvcGVzOiBbXCJvcGVuaWRcIiwgXCJwcm9maWxlXCIsIFwiZW1haWxcIl0sXG4gKiAgICAgICBpbmNsdWRlR3JhbnRlZFNjb3BlczogdHJ1ZSxcbiAqICAgICAgIGFjY2Vzc1R5cGU6IFwib2ZmbGluZVwiLFxuICogICB9O1xuICpcbiAqICAgPEdvb2dsZUJ1dHRvblxuICogICAgICAgICBwbGFjZWhvbGRlcj1cImRlbW8vc2VhcmNoLnBuZ1wiXG4gKiAgICAgICAgIG9wdGlvbnM9e29wdGlvbnN9XG4gKiAgICAgICAgIGFwaVVybD1cImh0dHA6Ly9sb2NhbGhvc3Q6NTAwMC9nb29nbGVfbG9naW5cIlxuICogICAvPlxuICogYGBgXG4gKiBAcGFyYW0gcHJvcHMgc2VlIElHb29nbGVCdXR0b25cbiAqIEBjb25zdHJ1Y3RvclxuICovXG5leHBvcnQgZnVuY3Rpb24gR29vZ2xlQnV0dG9uKHByb3BzOiBUeXBlR29vZ2xlQnV0dG9uKSB7XG4gICAgY29uc3Qge2NhbGxiYWNrfSA9IHByb3BzO1xuICAgIGNvbnN0IHsgb3B0aW9ucywgc2V0T3B0aW9ucywgcmVzcG9uc2VTdGF0ZSwgc2V0T0F1dGhTdGF0ZSwgc2V0UmVzcG9uc2VTdGF0ZSwgaXNBdXRoZW50aWNhdGVkIH0gPSB1c2VDb250ZXh0PElPQXV0aFN0YXRlPihHb29nbGVBdXRoQ29udGV4dCk7XG4gICAgY29uc3QgW3NlcnZlclJlc3BvbnNlU3RhdGUsIHNldFNlcnZlclJlc3BvbnNlU3RhdGVdID0gdXNlU3RhdGU8SVNlcnZlclJlc3BvbnNlPigpO1xuICAgIGNvbnN0IGN1cnJlbnRVcmwgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gpO1xuICAgIGNvbnN0IHF1ZXJ5UGFyYW1zQ29kZSA9IGN1cnJlbnRVcmwuZ2V0KFwiY29kZVwiKTtcbiAgICBjb25zdCBxdWVyeVBhcmFtc0Vycm9yID0gY3VycmVudFVybC5nZXQoXCJlcnJvclwiKTtcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBpZiAoIW9wdGlvbnMgJiYgc2V0T3B0aW9ucykge1xuICAgICAgICAgICAgc2V0T3B0aW9ucyhwcm9wcy5vcHRpb25zKTtcbiAgICAgICAgfVxuICAgIH0sIFtwcm9wcy5vcHRpb25zXSk7XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgaWYocmVzcG9uc2VTdGF0ZSAmJiAhT2JqZWN0LmtleXMocmVzcG9uc2VTdGF0ZSkubGVuZ3RoICYmIHNlcnZlclJlc3BvbnNlU3RhdGUpIHtcbiAgICAgICAgICAgIHNlcnZlclJlc3BvbnNlKHNlcnZlclJlc3BvbnNlU3RhdGUpO1xuICAgICAgICB9XG4gICAgfSwgW3NlcnZlclJlc3BvbnNlU3RhdGUsIHJlc3BvbnNlU3RhdGVdKTtcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBpZihyZXNwb25zZVN0YXRlPy5hY2Nlc3NUb2tlbiAmJiAhaXNMb2dnZWRJbigpKSB7XG4gICAgICAgICAgICBzdG9yZUFjY2Vzc1Rva2VuKHJlc3BvbnNlU3RhdGUuYWNjZXNzVG9rZW4gYXMgc3RyaW5nKTtcbiAgICAgICAgICAgIGNvbnNvbGUuZGVidWcoXCJgYWNjZXNzVG9rZW5gIHNldCBpbiBsb2NhbCBzdG9yYWdlLlwiKTtcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygc2V0T0F1dGhTdGF0ZSA9PT0gXCJmdW5jdGlvblwiICYmICFpc0F1dGhlbnRpY2F0ZWQpIHtcbiAgICAgICAgICAgICAgICBzZXRPQXV0aFN0YXRlKHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwgW3Jlc3BvbnNlU3RhdGU/LmFjY2Vzc1Rva2VuXSk7XG4gICAgLy8gQWRkIGFueSB1cGRhdGVzIHRvIHRoZSBvcHRpb25zIHN0YXRlXG4gICAgbGV0IG1lcmdlZFByb3BzQW5kU3RhdGVPcHRpb25zID0ge1xuICAgICAgICAuLi5wcm9wcy5vcHRpb25zLFxuICAgICAgICAuLi5vcHRpb25zLFxuICAgIH1cbiAgICBsZXQgX2lubmVyID1cbiAgICAgICAgPElubmVyQnV0dG9uXG4gICAgICAgICAgICB7Li4ucHJvcHN9XG4gICAgICAgICAgICBwbGFjZWhvbGRlcj17cHJvcHMucGxhY2Vob2xkZXJ9XG4gICAgICAgICAgICBlcnJvcj17cmVzcG9uc2VTdGF0ZT8uZXJyb3J9XG4gICAgICAgICAgICBvcHRpb25zPXttZXJnZWRQcm9wc0FuZFN0YXRlT3B0aW9uc31cbiAgICAgICAgLz47XG4gICAgaWYgKHJlc3BvbnNlU3RhdGU/LmVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYFtSZWFjdC1Hb29nbGUtT0F1dGgyXSBFcnJvcjogQXBpIGNhbGwgZmFpbGVkIHdpdGggJHtyZXNwb25zZVN0YXRlPy5lcnJvcn0gZXJyb3IuYCk7XG4gICAgICAgIHJldHVybiBfaW5uZXI7XG4gICAgfSBlbHNlIGlmIChxdWVyeVBhcmFtc0NvZGUgJiYgIWlzTG9nZ2VkSW4oKSkge1xuICAgICAgICAvLyBHZXQgcmVzdCBvZiBwYXJhbXNcbiAgICAgICAgY29uc3QgcXVlcnlQYXJhbXNFbWFpbCA9IGN1cnJlbnRVcmwuZ2V0KFwiZW1haWxcIikgfHwgXCJcIjtcbiAgICAgICAgY29uc3QgcXVlcnlQYXJhbXNTY29wZSA9IGN1cnJlbnRVcmwuZ2V0KFwic2NvcGVcIikgfHwgXCJcIjtcbiAgICAgICAgY29uc3Qgc2VydmVyUmVzcG9uc2VQcm9wczogSVNlcnZlclJlc3BvbnNlID0ge1xuICAgICAgICAgICAgZW1haWw6IHF1ZXJ5UGFyYW1zRW1haWwsXG4gICAgICAgICAgICBzY29wZTogcXVlcnlQYXJhbXNTY29wZSxcbiAgICAgICAgICAgIGNvZGU6IHF1ZXJ5UGFyYW1zQ29kZSxcbiAgICAgICAgICAgIGNsaWVudF9pZDogcHJvcHMub3B0aW9ucy5jbGllbnRJZCxcbiAgICAgICAgICAgIGFwaVVybDogcHJvcHMuYXBpVXJsLFxuICAgICAgICAgICAgcmVzcG9uc2VTdGF0ZTogcmVzcG9uc2VTdGF0ZSBhcyBJU2VydmVyUmVzcG9uc2VTdGF0ZSxcbiAgICAgICAgICAgIHNldFJlc3BvbnNlU3RhdGU6IHNldFJlc3BvbnNlU3RhdGUgYXMgRGlzcGF0Y2g8U2V0U3RhdGVBY3Rpb248SVNlcnZlclJlc3BvbnNlU3RhdGU+PixcbiAgICAgICAgfTtcbiAgICAgICAgcmVtb3ZlT0F1dGhRdWVyeVBhcmFtcygpO1xuICAgICAgICBpZiAocmVzcG9uc2VTdGF0ZSAmJiAhT2JqZWN0LmtleXMocmVzcG9uc2VTdGF0ZSkubGVuZ3RoKSB7XG4gICAgICAgICAgICBzZXRTZXJ2ZXJSZXNwb25zZVN0YXRlKHNlcnZlclJlc3BvbnNlUHJvcHMpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnNvbGUuZGVidWcoXCJXYWl0aW5nIGZvciByZW1vdGUgYXBpIHJlc3BvbnNlXCIpO1xuICAgICAgICByZXR1cm4gY2FsbGJhY2sgPyBjYWxsYmFjaygpIDogPD5Mb2FkaW5nLi4uPC8+O1xuICAgIH0gZWxzZSBpZiAocXVlcnlQYXJhbXNFcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKGBFcnJvcjogR29vZ2xlIGxvZ2luIGF0dGVtcHQgZmFpbGVkIHdpdGggJHtxdWVyeVBhcmFtc0Vycm9yfSBlcnJvci5gKVxuICAgICAgICByZXR1cm4gX2lubmVyO1xuICAgIH1cbiAgICAvLyBEaXNwbGF5IGJ1dHRvbiB3aXRoIG5vIGVycm9yc1xuICAgIHJldHVybiBfaW5uZXI7XG59XG5cbi8qKlxuICpcbiAqIEBwYXJhbSBzZXRPcHRpb25zXG4gKiBAcGFyYW0gb3B0aW9uc1xuICogSWYgZm9yIGV4YW1wbGUgeW91ciB1c2VyIHVwZGF0ZXMgdGhlaXIgZW1haWwgaW4geW91ciBhcHAgJiB5b3UgcmVkaXJlY3QgdGhlbVxuICogdG8gdGhlIGxvZ2luIGFnYWluLCBHb29nbGUgd2lsbCBieSBkZWZhdWx0IHNraXAgdGhlIEdvb2dsZSBlbWFpbCBzZWxlY3Qgc2NyZWVuXG4gKiAmIGxvZyB5b3UgaW4gd2l0aCB5b3VyIGV4aXN0aW5nIGNyZWRlbnRpYWxzLiBUbyBzdG9wIHRoaXMgaGFwcGVuaW5nIHlvdSBjYW4gdXNlIHRoZSBmb2xsb3dpbmcgZnVuY3Rpb246XG4gKlxuICogYGBgXG4gKiAgc2V0UHJvbXB0KFwic2VsZWN0X2FjY291bnRcIik7XG4gKiBgYGBcbiAqXG4gKiBCZWxvdyBpcyBhbiBleGFtcGxlIHdpdGggYHNldFByb21wdGAgZnVuY3Rpb24gcmVzZXR0aW5nIHlvdXJcbiAqIGBgYFxuICogICBjb25zdCBzc29fb3B0aW9uczogSUF1dGhvcml6YXRpb25PcHRpb25zID0ge1xuICogICAgICBjbGllbnRJZDogXCI8Q0xJRU5UX0lEPlwiLFxuICogICAgICByZWRpcmVjdFVyaTogYGh0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9sb2dpbmAsXG4gKiAgICAgIHNjb3BlczogW1wib3BlbmlkXCIsIFwicHJvZmlsZVwiLCBcImVtYWlsXCJdLFxuICogICAgICBhY2Nlc3NUeXBlOiBcIm9mZmxpbmVcIixcbiAqICAgfTtcbiAqIGBgYFxuICogVGhlbiBpbiB5b3VyIGxvZ2luIGNvbXBvbmVudCwgaXQgY291bGQgbG9vayBsaWtlIHRoaXM6XG4gKiBgYGBcbiAqICAgPEdvb2dsZUF1dGg+XG4gKiAgIDxHb29nbGVBdXRoQ29uc3VtZXI+XG4gKiAgIHsoeyByZXNwb25zZVN0YXRlLCBpc0F1dGhlbnRpY2F0ZWQsIHNldFByb21wdCB9OiBJT0F1dGhTdGF0ZSkgPT4ge1xuICogICAgIGlmICghaXNBdXRoZW50aWNhdGVkKSB7XG4gKiAgICAgICAgIC8vIEhlcmUgd2UgYXJlIHVzaW5nIExvZGFzaCBmcCB0byBnZXQgb3VyIHByb21wdCB2YWx1ZVxuICogICAgICAgICAvLyBwYXNzZWQgZnJvbSB0aGUgUmVhY3QgUm91dGVyIGxvY2F0aW9uIEFQSSBlLmc6XG4gKiAgICAgICAgIC8vIGhpc3RvcnkucHVzaCh7IHBhdGhuYW1lOiBcIi9sb2dpblwiLCB7cHJvbXB0OiBcInNlbGVjdF9hY2NvdW50XCJ9KTtcbiAqICAgICAgICAgY29uc3QgcHJvbXB0ID0gZnAuZ2V0KFwic3RhdGUucHJvbXB0XCIsIGxvY2F0aW9uKTtcbiAqICAgICAgICAgaWYgKHByb21wdCkge1xuICogICAgICAgICAgICAvLyB0aGlzIHdpbGwgbm93IHNldCBzc29fb3B0aW9uLnByb21wdCA9IFwic2VsZWN0X2FjY291bnRcIlxuICogICAgICAgICAgICAvLyBmb3IgdGhpcyBsb2dpbiBhdHRlbXB0LCB0aGVuIHRoZSBhdXRvIGxvZ2luIGZsb3cgd2lsbFxuICogICAgICAgICAgIC8vIGNvbnRpbnVlIGFzIG5vcm1hbFxuICogICAgICAgICAgICAgc2V0UHJvbXB0KHByb21wdCk7XG4gKiAgICAgICAgIH1cbiAqICAgICAgICAgcmV0dXJuIDxTdHlsZWRHb29nbGVCdXR0b24+XG4gKiAgICAgICAgICAgICAgICAgPEdvb2dsZUJ1dHRvblxuICogICAgICAgICAgICAgICAgICAgICBkZWZhdWx0U3R5bGU9e2ZhbHNlfVxuICogICAgICAgICAgICAgICAgICAgICBvcHRpb25zPXtzc29fb3B0aW9ufVxuICogICAgICAgICAgICAgICAgICAgICBhcGlVcmw9XCJodHRwOi8vbG9jYWxob3N0OjMwMDAvdXNlcnMvbG9naW5cIlxuICogICAgICAgICAgICAgICAgID5Mb2dpbjwvR29vZ2xlQnV0dG9uPlxuICogICAgICAgICAgICAgPC9TdHlsZWRHb29nbGVCdXR0b24+O1xuICogICAgICAgIH0gZWxzZSB7XG4gKiAgICAgICAgICAgICBpZiAocmVzcG9uc2VTdGF0ZT8uYWNjZXNzVG9rZW4gJiYgaXNPQXV0aExvZ2dlZEluKCkpIHtcbiAqICAgICAgICAgICAgICAgICB1cGRhdGVTaG91bGRGZXRjaChpc09BdXRoTG9nZ2VkSW4oKSk7XG4gKiAgICAgICAgICAgICAgICAgaWYgKHN0YWZmKSB7XG4gKiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDxSZWRpcmVjdCB0bz1cIi9zdGFmZlwiLz47XG4gKiAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAqICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gKiAgICAgICAgICAgICAgICAgfVxuICogICAgICAgICAgICAgfVxuICogICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAqICAgICAgICAgfVxuICogICAgICAgICAgfX1cbiAqICAgICAgPC9Hb29nbGVBdXRoQ29uc3VtZXI+XG4gKiAgIDwvR29vZ2xlQXV0aD5cbiAqIGBgYFxuICovXG5leHBvcnQgZnVuY3Rpb24gc2V0UHJvbXB0KHNldE9wdGlvbnM6IEZ1bmN0aW9uLCBvcHRpb25zPzogSUF1dGhvcml6YXRpb25PcHRpb25zKSB7XG4gICAgcmV0dXJuIChwcm9tcHRUeXBlOiBUeXBlUHJvbXB0KSA9PiB7XG4gICAgICAgIGlmIChvcHRpb25zICYmICFvcHRpb25zLnByb21wdCkge1xuICAgICAgICAgICAgc2V0T3B0aW9ucyh7XG4gICAgICAgICAgICAgICAgLi4ub3B0aW9ucyxcbiAgICAgICAgICAgICAgICBwcm9tcHQ6IHByb21wdFR5cGUsXG4gICAgICAgICAgICB9IGFzIElBdXRob3JpemF0aW9uT3B0aW9ucyk7XG4gICAgICAgIH1cbiAgICB9O1xufVxuXG4vKipcbiAqXG4gKiBAcGFyYW0gcHJvcHNcbiAqIEBjb25zdHJ1Y3RvclxuICovXG5leHBvcnQgY29uc3QgR29vZ2xlQXV0aCA9IChwcm9wczogYW55KSA9PiB7XG4gICAgY29uc3QgW3Jlc3BvbnNlU3RhdGUsIHNldFJlc3BvbnNlU3RhdGVdID0gdXNlU3RhdGU8SVNlcnZlclJlc3BvbnNlU3RhdGU+KFNFUlZFUl9SRVNQT05TRV9TVEFURSk7XG4gICAgY29uc3QgW2lzQXV0aGVudGljYXRlZCwgc2V0T0F1dGhTdGF0ZV0gPSB1c2VTdGF0ZTxib29sZWFuPihpc0xvZ2dlZEluKCkpO1xuICAgIGNvbnN0IFtvcHRpb25zLCBzZXRPcHRpb25zXSA9IHVzZVN0YXRlPElBdXRob3JpemF0aW9uT3B0aW9ucz4oKTtcblxuICAgIGNvbnN0IF9wcm92aWRlclByb3BzOiBJT0F1dGhTdGF0ZSA9IHtcbiAgICAgICAgaXNBdXRoZW50aWNhdGVkLFxuICAgICAgICBzZXRPQXV0aFN0YXRlLFxuICAgICAgICByZXNwb25zZVN0YXRlLFxuICAgICAgICBzZXRSZXNwb25zZVN0YXRlLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICBzZXRPcHRpb25zLFxuICAgICAgICBzZXRQcm9tcHQ6IHNldFByb21wdChzZXRPcHRpb25zLCBvcHRpb25zKSxcbiAgICB9O1xuICAgIHJldHVybiAgKFxuICAgICAgICA8R29vZ2xlQXV0aFByb3ZpZGVyIHZhbHVlPXtfcHJvdmlkZXJQcm9wc30+XG4gICAgICAgICAgICB7cHJvcHMuY2hpbGRyZW59XG4gICAgICAgIDwvR29vZ2xlQXV0aFByb3ZpZGVyPlxuICAgICk7XG59Il0sInNvdXJjZVJvb3QiOiIifQ==